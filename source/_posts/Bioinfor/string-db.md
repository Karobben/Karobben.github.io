---
toc: true
url: string-db
covercopy: Â© Karobben
priority: 10000
date: 2023-01-09 21:01:48
title: "String DB"
ytitle: "String DB"
description: ""
excerpt: "String DB in action"
tags: []
category: []
cover: "https://version11.string-db.org/images/string_logo_2015.png"
thumbnail: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADjCAMAAADdXVr2AAAA2FBMVEX///8AAACStK8jHyC6ZWHq6urx8fEVFRWfn59qamqYmJguLi4iHyAhHB309PTn5+fT09MdGRpBQUE1NTXc3NwZFBXExMRcXFy8vLywsLAjIyPNzc3i4uJ2dnaqqqoJAACOr6qJiYkMDAxHR0ebm5tUVFSCgoJwcHBUYmAZGx23trZMTEyNjY0rKysoJCXJyclASEelW1iyYV59mJRofXpkPDtiYmJcbWqmXFlKMTCHTUthdHE9OTqIpqJzjIgZDRBIUlByQ0E5KClGLi6QUU8VAAZXNTUIFxhi/FV+AAAZa0lEQVR4nO1deV/iPhPfipSzhZ7cRYqAnLrqsoco6rr+3v87epqZ0JaS9MCyyH6e+WM/q0KbbzKZO5MvX/5PqZHs0LHHcCDSr+uN4qxXnNSr2WOPJW0S67Payujatt3tSv1RvnXsAaVK9aVmGFIGSVIMRe3oxx5TaiTXFi42SopSmh17WCmRKSC4crk8Ho+df3ENhf4/sQWtjAJ4xuXX3+/fvr3/fh0jQKN/feyxfZhkSyPoyuPM+6+3H+fn57df315+IkCjXz328D5KdYru/e323KWvv17HgK/WPvb4PkZtzSDoMi8+cADwHRbQ6Jy2lh8AusWv8yDdfgMR020ce4QfoYnAQecQ4JMM8dhj/ACpZOONX1jozm9/kv3X7R17jPvTBND9ZKJz9h/hTql07EHuTx2DCM03DrzzF7J8Sv3Yo9yX2lNn9cbvtzx4X1F4HnuY+1Jdc4wx/uI50tNZPmVwqrqh6KArv37lwjv/ReD1T9V36BmEN3/w4X11dIOknerm660deN+4W8+B9+rAm5+qZu/ZUfB+E+GSP/Y496SY8C6PPc49KZo5Fw5zlibHHueeNCNa/WeIaHkjomVlHnuce1J+If3LigHVOtNdALp9J/Bqxx7mviQOoowyR7IoJ2uUmWT1ymMud5LFy0jN4klaZe2RIED8b8ETLP9hQFDI1U8OYCUvOAQhwPE3JrofrxAus8nn+vpJAcxO+mTUgo3hW5Z0+fEO6BQBaXZCMUGzIGxIwWDLjnhx0AE894Nq8USC1u1OaTPm5oSGyr4FlPvbbwhUd4v6yAU4OAnr7HLsDtiRia2VBPz56mfQ2/cMrJ1Cwrgtzf389LNzqFxvbsY6LlScX1zPFdx/YxKoJvTj18//xjRPJFjkSw0P4Ogzh63llrfpluCltgeCTXNf5fF/48Xr6+I/mkFBsQIGZ3bmArTzn9ZG02c5l80slPQdMmJlk90rlzfpr0zGsOHDTURzPXS/uqp/ysiuaPVdiTKjS1DEnwtaN5i+7NYaCIhGkmRz6XHoJ/Qh6gPbHV6VKukJ/lyT9ZkhGC42yRBWVmXz1yF9gDhxZdJ8VDkaDiZlB+7cz92511e4ncj/xcagayDZGdyXX4b4BS8YMXQfkhsG33BEkmfuuEqe8moj5Jy7EvrEcsh0t5aM/Jjz3PVKoezKmMknsdOynmAv9TzBLuNajEPifG3crX51V/fJXvMzAPQNaOhPlufxd7OwMV7jxBR8slJsqO4C9o6efK92XD3e3/Jrrps7I2eQldsSL0D6pcuhpcujyhhxtnKFQX5rJCKi06KsEGpyWlu/9Bmi0yMGeSdzdxijwCpRDos2IpE97QAbVj07TT2YGSOLhDibR65O3U0yDdaIdViLwqQsLrMaXOZLdwsKSyaDy2K20m5Xstn9BFC71egVCPWsFsOZ1nvu6wc7YXQLNXSsKJGJO60QdPcqHuOXrZ0t2L6+HJUWhP37nUY18Q41izVJsFENd43BLBAOyV6679Yud/YX9XGW8RzUvM0RsS1vBmuNrb9eO6PrGhKJVEmKISwKu/jDqDrUur4qN0mxtZF/d1g198WM0r4Kcm3cmiOqIHO7wXi55RpDuYJniGZnanerBk8yjGUjNo/KxVWwgi8jrVezzRbQa655qV7vPlVGRdiMnTvI4mSNGTJEnLh6p9mhzGAOFMVzQKgHYiw6MYMZ2ZqtwJekDSFAuwbvFz3LcM4UHfTvxbjoXONUYIkQ2fOy7EtnLuX8wthg24DEFdRicUtFtRFORru5cuj5RlsogNBYtRwLzNW5Wo85X3UhvljZEHUeBuwBeYZoycxeChjdyLy+v/x6+/r269vPVwSorGPga08NBHfzcHeGdPfwvKD4THczNEfsguEqTvY0mbguhq54o+DuhsEaV+z3y5sXl/qGFXhKKVJFZguAztDuH888eryH+iI3KkliDezxUzehmTQohIqyybG/xQbVsTZlzJetyP7t2ztEvKMrDC8zZJ3Wz3dn2/R4tcYtjMNocPbxZmMmLgdoo3jh7p+2BX+ncam3YNz09gUiOEqoAe8olJUC6B7PgnSB+MqETfhlitRN2CNd3sLg6JSrwIh8pWv3dr5DiE/RQuMY4pCIFYWBzqEreLhih3AAFSvDfeykCe6vEf+71b7BQwc1QA4+exjmoVwT1pRugpxJ+fOGrKwRUsGuo5Ia7GcEU/ESEqsuGrDvWOjOz3/8JAWUmRAXUSaLJy3umejOzp7mEqkB486PjPt/vqcTKlM3iMtfOqRDf/Lyhb8WDr5uyO7LLmDxLjjwLq4UUqHIPUFCxcrelQ5ZNFXnPPFSX0PdMgfd+S1ZPmXFN15Mkm+UeIt3dnZPlq/LG/4m+rAvOmdz4RM4m1ueObxV/s0vRXhx1Hs5xMUckq0r8RaP7D6J7F728tPsQkJ9HnhGmGjKLsnWe+eiO7/NEO7k792+w3zKDRedIzzJ5mP7OVWMeoXwRhwKUyyVkhTGmw6RfK8x4j6cpPqNqxB4D2R1SyzVJKJcKH0wtpXt8MVLG7Yev44EaxGUPvfhXaLS+VvP2XwEnsaCh4HccYzoQzjpyAQaQ7e0BZIIDakCguplZcV9NpEs66d94Fkf0OfbVN3KrKQPb5/VayE6NY2w8ka8MOFlPgKPJIqN78nhZWlUK53E3JBjvbRJiVro3gPFx997xOtRnkPgEcmpDILCkUYfhLROjKJPNQ7q1wox93kmGRBITn5uiZw7kOYh8IjVuWuVzfZ2E9hExUvQdBULEXrvB+g9vnRrgNXCly1PRHPsnGqi4YkUD3OZNLMSYJN8l1TWv/G3Hhy64tvzbRIgk/iK7ztxdbsBV7WaKKgZj1iZFQf1OsRhcBaPlC4rKl8AiMTskTS2P3R2dqdKEHDZeqvcD3ez9yNWEN9Swd3j1r++AG+GbZG6AN4s2+q8QH/W2A6JYBDBTjmRI++kYKor6qzzqrPfiGCRuO4GoTbUSEnfmfju1+itg+Hcojtt9mE3gU0VZM8SZfk2LKeNB1WDRzmBvsJ5uXV4sKUBHl+GpdrvJQ+dQz2YJpr/WKaNzmEkxAfZoXaeZto2+BjovsFxsojAf3YEy7fYWb+LewjlSqqbeNPy7S868hA//vMBct1HeeJmNMYqxRcsr3+Dw9TSIsrm1eEBknS1LV/ursqAzqhWvRj8Mk+jd4dJgffg4c1Zx43hFswqHIIvl9/f/OBuNyepo5VTC2vAJO27Fy57vNIg0SCRQIPccquPkHKzKp/M/N7Uo4lbd+lIEqi6RnyLd7dG9MfL7wyeg49j81pdheZP1Kunu7PHp+8qzaIoBrWTGtv4bFv4C0S9kerczaD8/Pby8vLtlSZRJEOLZfOaK4XmhIz1+s96bWx+Wrn6QByWoseTJpWXrjFSneLwyhnSgoI0oYDhKYu4ZlOrICmZICnK0m8ytzrl6EGlRXbNb163hwsjODpp3c/HNgorVl/YBqgIK2s7fiXX/x68gMEn15fb2VmlW0pWaq43VsKa8ijRdav8zterMceW25uam8TljlqtmJ0FzRY52Lr9YjWpPS9Wh1MUMobaazE2bWcz/p5YCaHs3iSaGx3LMGjlrDlbKg4ZU6u6rxtdImK5wPxT2607WR2q8ZGnYdmtCWQoL/lA/TzIRza8osd+KQSQWGR6NU8DZtxaBOZNkMMPEh+eCAEIDSLTuYMUB2PkNIexb6ZDckB4Jrx2NgSNXjvE8mE5QS0PG5CZtjsgPHCE7AlN6hygbE+GJ9t5rBlk5uoPBw9dBWdLULt+/1fwCB3J/qYmi+UKHA6eCS8nTiwK0NQru0WcttZGRM8ZoZyDwRNrrjrCAHUu7dM/6GrBq1HBMsTXweDp3supdmJrj70JfXUblgzNI8YJ4oPBw42Bdm4b1BOv4GY/Qu7YBIbRv9zlzoPBg/eN6Q+YHVqmGZCw8Mhpxf+CXcvlUPAaW+KE1lmlqBz0qY87vtDZbO587FDwUNm5unwCrymnVtJND7V4uYwee/4OBE8H1vF5KR0O9+xJLTCVS56sbLOFy4Hg7UjqFhqGaSmHQlCVinDYSAt6JoeBVwFJpvolGSqH6f4v8hOGAeZ+JwHtzyCQw8BjWEmykKJ0ae5iQRuwFhDOB4EnA28GbFyU3ank1vNbWocSeJd2IF97EHjoCgVd2Gla0qXdDO5seCnYDr3tlx4EXnFbJ1Fq2czdn5xQbgVLi9B7DrDMIeBh4nsnOkDPWnw4LmGWGDi+sN2iQ8AzOVyIB2vKH4xLZEdMGUmOH8Dm3nLaDwAPa0rnDBRoakQcR4wiVApThgHU2VWtB4CXhbew+hvRg7Af8hxQpTJLSBhu0QHgDfkKDs38D5UmUeeDuYEDhu6Xg8ADCGX2pwcfVQ5oW+bYDNDYeXr68HBvcCIrNOuwv+dQYCoFSjKqHt9v0oeHC8TzXJFz964jQKHMcMt9T7d9S5s6PB1cFa7pXEHm2tf0HHCUAqVqcG1Th4fLw9dtNLK8X/3VJXy5yRVNO25R2vAYrtA20XOUeyVt2tOIuaMb34OTNjysZAsbfB24d7WPYxuMQOwShmC8mFXK8Jiu0DbJNC6R3PTEE2Asc8ij2bZwSRnedSlqfjemp514+ei8hAfz6+AWuWZ7yvDQ0Yyoa8JhJo5LYCw/gquxqrm5UazpwsN4ZlS3UBkrXhIqBxmd2KjCQnSLNs9OFx7PFQoQ2o12shchY6hRH8vCCXCNcmeq8HB3xDicp8ZaiC2i6a5obwNZn6q+VOGhK8Q+Wr5F1/DBUhLpMoz7bN3/wVThoVERp5p/GEMIblELayDiTAj2J0DuTBUe8k+cb1VBt4f1gAoQslyscVo+zk8THgqWeK0ScAzBqGvEx3ca0rAJOR/+myY8tCbjjZiesY+pHCqJPo2WCyjfFOFhdDWutm4Ae87jTQYqhbjpTxQu4BalCG8WU3IjybV4OpIQTV7HPS+NAV2ViKH04GEPwHns5qA0LhFHFmJkM76L33AleHrwJlB7m8CP6yTTZDE3NXwBnE5y+Ds9eKDKxgkK+mlKLPosbckn6eNRcbNPUoOHbs5Or60wQmkfeYUgfmwc8aktwjSE4xalBs9y+T02ibBb7YiXY+ogmX+BfS/HemrwMISS8DLAuu2KOD7RxEQy5x7donxq8NDXTHizAE2JhR7Jov3aEqaVRBiWJssfhFeZkxMmAxQs5aTJEYxdhCkH2noocWQGxbJuKrYzvL3O1smVybIr4NkawSDHaJLXPSDnDfixGbRjk9+A2XY2dU7B+xAydnc5qSSbIFkfGsL2SYg9UiM0ncW1R7IRYWn+8AT/MRTJGeowyY0H7WLJ9mOD0wyF5HlzFLjcuDP+eZo4pt3qBM8ASXapGNuiMmuK+33JhWms4p/S2RAGnjmOLR5DSFwMI+dXRnlndIpSizn9DQ2XXlLWf9ba4s/mCFj8M1YuocXF6m34ZePU83sgsEnuLBTKk+s/C80ZIj0LZKxiTZR7fm/xjAf0776X8ACfZCS+VAdlHLNUl7b2SJgNlGsw2c6ASt/xgOjT85weLwxpOOBSvYtfv3nwHZ+9wyaB5W7SknBsDZtjvbcWxrhcGnXhKOLC3wbv4uEGpz/YMWCXqtBmTlp83+7EdnGPHBun2+0WceMSmI7REsoVqwt8qN1vH11+/A7Tr0S1Cc6ODDjcvnuy++6G4FOSJn8qW1XRO79POFs4+QajTxw04Sobo/DpmsC5dQY6gg8enVS8YMOMnTjRXgXYcgemmNkFD/BJi1Cnv7LErgOMrzv4AHrSuxxpM5eA6dTGRFJCpQCXikkldk8L6NdhhDptdcLavJ4RZ/dk+Xhtyrh0zYjRUnM7sZEOfV853Y4unsnwwqSLPArt+PFIHiAl7u3BKNXFUExo+woGVcnicdpPEu6CPmQhm6dC5KvE7yZ0v4iYHybRvuH+r61YDBtJE8Jb3AaNZ2fPsPuiegTyu+08koYtRuKiRhQjK8/0xAIKO+FzRNLjT7rhLR5t2hHSsakH/Su5X8f5URLbwHIgJbbnob8suWM5pBfQ2QWBZ/M9mxqZHjUEHjTRWyU+ToNbzVWZ6Acm7pVYIX3GymFt1IC5+D0CidIM7RH4BJuvKiccmbyVEov24pnPkKvQhi2sCR5pBxTWhk2JaMN2Nwf2zvVHRVPX29m4xY3YLgrDGQlrQ+RsRddb1nCZA8Ew54l1Qt9TgUcbfORWy6FVN1t6DGbF0Cs0R8A+njGMO7ldNeuN4mhAmw/YqcCLZM7MVv8SuzQtzIpWvRUKsuKeEssuoyMQYtW08sXhsr/VdgN0ejhzKqHwiGgJbT96D94Ioz2LPV8NCp1evs4LCWBsspSlGRD2OXsH2HVjNizU+lqO8Q7wycJECzTB4/uk0EQvTDFcScHFC4xgPNfUZa/B4Lw+lS4QgbB3A97Z+uWoppWaDFwbAns4jLkWYLZw4dWj1DrpjWsUir2aqs1z4T125rXZpCKKrpClmSCUK+4My7KYbV121BBQAmk9UNJqo2JNCeu77GwdkHt8oyq7Dm+i91RyewTK+iQ/7CwHWjN0YM3BMN+qOjJW9jqECEQpiI48rJqzUT8UmK31a6PhrHENlkSjS/wF/uwT3pLWfKMjooke9KV2jDLP7JEr5iR/2Rv1tbBBCs1+odfIez9rptWpsbaXb8H6tWExb5m+ZiXyJXR0v+ItH5rU7GtvkMDX5y4fdBXPKII2C8yQqLfMujWrqWED9lpWCeOQTwn2oDBrmGa1HVCMZqcMm2/OWz4QDDv9J/2k9xX++mNP+AyZ9AEriCBn27pezy/7YYMPBbbsWC1dr7BuFsqS5lM5CIhxjGqY/Ij7v/OwfEz2vLjx3zhR46tlWZZbVmcaukQBanZmZiXM1LOQ+3EETOlyV4LFC89BtmsQzWDgu8BQmeLumIiozRfS0ajYcVRYacyWseOmpg6WxUZkpFO+drkexrBmhBPuNJALUddp1GESJOUp8AQMlGXsTtG9X0mId7dRttooOjJ2WvKWs6nVCsNeg2sDbIPTXZlrL/Eqk3UwmHTxhB0MS5GutoU3vShXd/4w7gNMTqa7lL9UvUtGB5PYB4ZE3WxYEFWa96z6dfyMVbvoqh41L8pLMM0U7cEfxr27olftxIgrDjFtJmlX94jw8f5KxTB3d0nm23+30yhRZALc9kQ3ssl571JNuA61PbUxRaBe4WU0F3f3VxpmGWKFvMUO3qIqKQvthpA6p0kKRPeFGFAuozWHCZxbUH0R2fYtMgcup/SpotCXXZrgmaswvM0tSRK749AOyfnNPbiSpCgK7X9YVgzfdanizBUXzfh5sYTwst4tg74WBJWR4V5yBcOj+SIl9jhay0XwEjDFULdlrl5wV1CLe9t9InhZz8zRilvrkleNQP5SMhbLBEwhWsuFrUgeNqPf29kyDe+ms1G8ZyeAJ9ZdO6/ZCX5D7/UND6Gk2IullexUZGUynCpCF8hedSzWmLJ57xrkYhyBER/etWeAF1jSq2p1VjaOTlAGvUnyZjHEkCwSslrcJnxtr9fc9DKaQ+PC03tugzmVe19VtWXB8EzW3Y7xSCYU+gHdbctr9yMr6mLC864nFy5DeS5yeCmQ6Q0m6uBeLHitcezn/RWS854jVAzdBNHwZN29l9wefJZ7ydsz13Ba8fYKoUh4etGNjW0upP8UZEZIOqQIeFnvQvpcLEn890isu5fsNoe8oYXbnHWXL4XOoTqa7k+yZ2XMmZm79qRg5AxbmzHx6f4bLj8RX/rIM2N2slt6b2GjoSEZa2PHDvFdSJ/7QDfYA9N1zbXwp75mw3Jr1O1KfhNRGPhXSKy7X5t3jnoFeQTJDc8X7G2WSC8qO32yDcPdofK1eyG9PfosyoBHbctVyyssQmwNNitHHJiNoS51pwilOnS1SgLv/3hU9ZTEwNmCE5UWGK7X85vn52fNWNMSPo3U2PQ8myD/mfnSR15kK7ccrlCgrBcPjxdAj/faHyzhK00mXlB0FLve9PhkuYaojQWG2lbi6knNYAmfC27nQvrPTeLQF3iVFsHEwMX3uf9qlWlqN1D9NWp1xjRsLpUeduOu94iP3EKszk5k022RbC7xpID0wAiaw21wJHon7Oj4UyG5D5FxTgke3LIsLfQTUAZsgntsMwYvIQcVmJnTkil+KsL92EzWJHRHlk9JvWP3XyNI9pa4NW6QUlMYt1yeBrWnUAbEz/WTW8Wkg91WcWgy4S7NkDobUr4cfbHVZyWLjD6sSgrqQzOnp9KR8pnw8lKsXjZSa/j8lykSHlxYuP6H4Smh5bOfmwCeGrb3gDlTv3nxL1GjFCFaoI4o83lDR+EEiiHsiuw7ONFzgHti/gpB6brBrQFDtR5RR/SZCQ61LLiy5RFq3BIfefw01AB/iFucDTe9KqcqWRx/DxyiDEe4PKJDdEIRpCD14EQZp4D2mQQIQ05VfH4SIaTJrjCF83YZ4YQXb3PQmHEo7eIKy7hO1Z5Gkod4DbYa0H53z3CBdGhp8CkQHlfNKJkHr8Lw4u6hhKhZzd9Pi/QaVlCutav7p7vHx7un+ysNswxGdKnI5ydaopiRFKmk3tyopQytV/sn0EFvI1r/JQHR/0e3iToVmqwyylaFIVnJUw2xMEjOD0q2ARDLkmLYi8HspPXdDlUmvaU6NwShu1CXPevfAgfUbpn1yWRitv5BbP+nQ9D/ABreWCAkyPTYAAAAAElFTkSuQmCC"
---

## String Database

### Download Specious Network

[Link to downloading the networks](https://string-db.org/cgi/download?sessionId=byDJhSpQeXPo&species_text=Drosophila+melanogaster)

An example of download files:
- Link file: `7227.protein.physical.links.full.v11.5.txt`
- Protein annotation: `7227.protein.info.v11.5.txt.gz`

```r
TB <- read.table("7227.protein.links.detailed.v11.5.txt", header = T)

dim(TB)
str(TB)
```

<pre>
[1] 4343798      10

'data.frame':	4343798 obs. of  10 variables:
 $ protein1      : chr  "7227.FBpp0070001" "7227.FBpp0070001" "7227.FBpp0070001" "7227.FBpp0070001" ...
 $ protein2      : chr  "7227.FBpp0293850" "7227.FBpp0087873" "7227.FBpp0079990" "7227.FBpp0080090" ...
 $ neighborhood  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ fusion        : int  0 0 0 0 0 0 0 0 0 0 ...
 $ cooccurence   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ coexpression  : int  151 153 167 298 446 371 242 371 373 238 ...
 $ experimental  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ database      : int  0 0 0 0 0 0 0 0 0 0 ...
 $ textmining    : int  0 0 0 0 0 0 0 0 0 0 ...
 $ combined_score: int  150 152 167 298 446 371 241 371 373 237 ...
</pre>

- Protein 1: Start protein
- Protein 2: Connections from Protein 1 to protein 2
- neighborhood: Physical neighborhood on the Genome
- fusion: raw fusion score for COG mode (deprecated).
- cooccurence: raw cooccurence score for COG mode (deprecated).
- coexpression: expression patterns in a group of RNA-Seq are similar
- experimental: experimental score (derived from experimental data, such as, affinity chromatography).
- database: database score (derived from curated data of various databases).
- textmining:  textmining score (derived from co-occurring mentioning of gene/protein names in abstracts).
- combined_score: scores in total

From:
- [Table: network.score_types](https://string-db.org/help/database/#table-networkscore_types)
- [Starting Point](https://string-db.org/help/getting_started/)




!!! question How do I select a reasonable score cut-off value for my analysis?
    You can use the score cut-off to limit the number of interactions to those that have higher confidence and are more likely to be true positives. Setting the cutoff lower will increase coverage but also a fraction of false positives. You have to choose some **arbitrary number** based on the number of interactions you need for your analysis.

!!! question What is co-occurrence
    A type of phylogenetic profile â the patterns of the presence or absence of orthologs across many organisms[Â© Pan-Jun Kim, 2011](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1002340)

### Example in R

```r
library(ggplot2)
library(stringr)
library(igraph)
library(reshape2)

Anno <-  read.csv("7227.protein.info.v11.5.txt", sep ='\t', header = T, quote = "")
Anno[[1]] <- str_remove(Anno[[1]], "7227.")

TB <- read.table("7227.protein.links.detailed.v11.5.txt", header = T)
TB2 <- TB[c("protein1", "protein2", "fusion", "cooccurence", "coexpression", "experimental")]
TB2$protein1 <- str_remove(TB2$protein1, "7227.")
TB2$protein2 <- str_remove(TB2$protein2, "7227.")

TB_df <- apply(TB2[-c(1:2)], 1, sum)

N = 18+ which.max(density(TB_df[which(TB_df>0)])$y[-c(1:18)])
X = density(TB_df[which(TB_df>0)])$x[N]
Y = density(TB_df[which(TB_df>0)])$y[N]

ggplot() + geom_density(aes(x= TB_df[which(TB_df>0)])) + theme_bw() +
    geom_vline(xintercept =  X) +
    geom_text(aes(x= X, y = Y, label= round(X, 2)), hjust = 0, vjust = 0)

# LIST

LIST <- c("FBpp0070483", "FBpp0288697", "FBpp0304573", "FBpp0305946", "FBpp0300852", "FBpp0083503", "FBpp0297544", "FBpp0085082", "FBpp0288660", "FBpp0077739", "FBpp0081139", "FBpp0293081", "FBpp0079676", "FBpp0288515", "FBpp0297890", "FBpp0304299", "FBpp0306192", "FBpp0074686", "FBpp0070417", "FBpp0086911", "FBpp0289616")

# Try threshold at 2000
# TB3 <- TB2[which(TB_df>1000),]
TB3 <- rbind(TB2[TB2$protein1 %in% LIST,], TB2[TB2$protein2 %in% LIST,])
TB_df <- apply(TB3[-c(1:2)], 1, sum)
TB3 <- TB3[which(TB_df>150),]
length(unique(c(TB3$protein1, TB3$protein2 )))
# 173; we have 173 unique proteins


# plot it with igraph
TB3$CN = 1
TB4 <- reshape(TB3[c("protein1", "protein2", "CN")], idvar = "protein1", timevar = "protein2", direction = "wide")
rownames(TB4) <- TB4[[1]]
TB4 <- TB4[-1]
colnames(TB4) <- str_remove(colnames(TB4), "CN.")
TB4[is.na(TB4)] <- 0

network=graph_from_adjacency_matrix(as.matrix(TB4) , mode='undirected', diag=T )

TB4.Size <- as.data.frame(table(c(TB3$protein1, TB3$protein2 )))
TB4.Size <- TB4.Size[match(colnames(TB4),TB4.Size$Var1),]
TB4.Size$Anno <- Anno[[2]][match(TB4.Size$Var1,Anno[[1]])]
TB4.Size$Anno2 = ""
TB4.Size$Anno2[which(TB4.Size$Freq>=100)] <- TB4.Size$Anno[which(TB4.Size$Freq>=100)]
##DefauTB4.Size$Anno2 = ""
set.seed(1)
par(mar=c(0,0,0,0))
plot(network,    
    vertex.size= log(TB4.Size$Freq +1),
    vertex.label = TB4.Size$Anno2 ,
    vertex.label.size= log(TB4.Size$Freq +1) ,
    vertex.frame.color= adjustcolor("salmon", alpha.f = .5),
    vertex.color = adjustcolor("salmon", alpha.f = .5),
    edge.color = adjustcolor("grey", alpha.f = .1), layout = layout_nicely)

lay = layout_with_graphopt(network)
R = max(abs(lay))
lay_Y = abs(asin(sin(lay[,2]/sqrt(lay[,1]^2 + lay[,2]^2))) * R)
lay_X = abs(acos(cos(lay[,1]/sqrt(lay[,1]^2 + lay[,2]^2))) * R)
lay_X[lay[,1]<0] <- lay_X[lay[,1]<0] * -1
lay_Y[lay[,2]<0] <- lay_Y[lay[,2]<0] * -1

LX <- 2*(lay_X -lay[,1]) #+ lay[,1]
LY <- 2*(lay_Y -lay[,2]) #+ lay[,2]

LAY <- matrix(c(LX, LY) , ncol = 2)
#layout_with_mds
#layout_nicely
#layout_with_graphopt
```

|![string-db Density plot](https://s1.ax1x.com/2023/01/10/pSejUfS.png)|
|:-:|


<style>
pre {
  background-color:#38393d;
  color: #5fd381;
}
</style>
